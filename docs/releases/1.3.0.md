# Release Notes: lsh-framework v1.3.0

**Release Date:** November 15, 2025
**Previous Version:** 1.2.1
**Type:** Minor Feature Release

## ğŸ¯ Overview

This release adds **intelligent fuzzy matching** to the `lsh get` command, making it significantly easier to retrieve secrets without typing exact key names. Now supports case-insensitive and space-separated searches.

## âœ¨ New Features

### Fuzzy Matching for Secret Retrieval

The `lsh get` command now supports intelligent fuzzy matching with the following capabilities:

1. **Case-Insensitive Matching**
   ```bash
   lsh get stripe           # Matches STRIPE_API_KEY, STRIPE_SECRET_KEY, etc.
   lsh get DATABASE         # Matches DATABASE_URL
   ```

2. **Space-Separated Multi-Word Matching** â­
   ```bash
   lsh get "stripe api"     # Auto-selects STRIPE_API_KEY
   lsh get "database url"   # Auto-selects DATABASE_URL
   lsh get "stripe webhook" # Auto-selects STRIPE_WEBHOOK_SECRET
   ```

3. **Smart Auto-Selection**
   - When there's a clear best match (score 2x higher than alternatives), automatically returns the value
   - When matches are ambiguous, displays all matching options for manual selection

4. **Exact Match Option**
   ```bash
   lsh get STRIPE_API_KEY --exact  # Only exact matches, no fuzzy search
   ```

### Scoring Algorithm

The fuzzy matcher uses a sophisticated scoring system that prioritizes:
- Exact matches (case-sensitive and case-insensitive)
- Prefix matches (keys starting with search term)
- Multi-word matches (e.g., "stripe api" â†’ STRIPE_API_KEY)
- Substring matches at word boundaries
- Position-based scoring (earlier matches score higher)

## ğŸ“ Files Added

- **`src/lib/fuzzy-match.ts`**
  Core fuzzy matching engine with scoring algorithm
  - `calculateMatchScore()` - Scores search term against key
  - `findFuzzyMatches()` - Finds and ranks all matches
  - `normalizeForMatching()` - Normalizes strings for comparison

- **`__tests__/fuzzy-match.test.ts`**
  Comprehensive test suite with 33 passing tests covering:
  - Exact matches (case-sensitive and case-insensitive)
  - Prefix matches
  - Multi-word space-separated searches
  - Edge cases (special characters, long keys, numeric searches)
  - Scoring prioritization

- **`types/lib/fuzzy-match.d.ts`**
  TypeScript type definitions for fuzzy matching module

## ğŸ”§ Files Modified

### `src/services/secrets/secrets.ts`

**Changed:** Updated `get` command implementation (lines 438-552)

**Improvements:**
- Added `--exact` flag to disable fuzzy matching
- Refactored secret parsing to support fuzzy matching
- Implemented smart auto-selection logic for clear matches
- Enhanced error messages to show all matches when ambiguous

**Before:**
```typescript
// Only exact key match
for (const line of lines) {
  if (match && match[1].trim() === key) {
    console.log(value);
    return;
  }
}
console.error(`âŒ Key '${key}' not found`);
```

**After:**
```typescript
// Try exact match first, then fuzzy match
const exactMatch = secrets.find(s => s.key === key);
if (exactMatch) {
  console.log(exactMatch.value);
  return;
}

// Use fuzzy matching
const matches = findFuzzyMatches(key, secrets);
if (matches.length === 1 || (bestScore >= 700 && bestScore >= secondBestScore * 2)) {
  console.log(matches[0].value);
  return;
}
```

### `eslint-plugin-lsh/rules/no-hardcoded-strings.js`

**Fixed:** Syntax error in ESLint plugin (line 20)

**Issue:** Invalid JavaScript syntax due to malformed comment/code
```javascript
// Before (line 20):
The rule has grown quite largeâ€”consider extracting...
  meta: {
```

**Resolution:**
```javascript
// After (line 20):
export default {
  meta: {
```

## ğŸ§ª Testing

### Test Coverage

- **33 new unit tests** for fuzzy matching
- **100% pass rate** on all fuzzy match tests
- Tests cover:
  - Basic matching scenarios
  - Multi-word searches
  - Edge cases and error conditions
  - Scoring algorithm validation

### Manual Testing Performed

```bash
# Single word fuzzy match
$ lsh get stripe -f .env
ğŸ” Found 4 matches for 'stripe':
  STRIPE_API_KEY, STRIPE_SECRET_KEY, STRIPE_WEBHOOK_SECRET, MY_STRIPE_TOKEN

# Multi-word auto-select
$ lsh get "stripe api" -f .env
sk_test_123456789                    # âœ… Auto-selected STRIPE_API_KEY

# Case insensitive
$ lsh get DATABASE -f .env
postgres://localhost:5432/db          # âœ… Matched DATABASE_URL

# Exact match only
$ lsh get stripe --exact -f .env
âŒ Key 'stripe' not found             # âœ… Requires exact match
```

## ğŸ”„ Breaking Changes

None. This is a backward-compatible feature addition.

- Existing exact key lookups continue to work identically
- Fuzzy matching only activates when exact match fails
- `--exact` flag available for users who want old behavior

## ğŸ“Š Diff Summary

```
Files Changed:
- __tests__/fuzzy-match.test.ts          (new, 281 lines)
- src/lib/fuzzy-match.ts                 (new, 87 lines)
- src/services/secrets/secrets.ts        (modified, +70 lines)
- eslint-plugin-lsh/rules/...            (modified, -3 lines)
- types/lib/fuzzy-match.d.ts            (new, auto-generated)

Total: 2 files modified, 3 files added
Lines: +435 insertions, -3 deletions
```

## ğŸ“¦ Installation

```bash
npm install -g lsh-framework@1.3.0
# or
npm update -g lsh-framework
```

## ğŸ› Bug Fixes

- Fixed ESLint plugin syntax error in `no-hardcoded-strings.js` rule

## ğŸ”œ Future Improvements

Potential enhancements for future releases:
- Fuzzy matching for other commands (e.g., `lsh env`, `lsh list`)
- Configurable fuzzy match threshold
- Fuzzy match history/learning
- Support for regex patterns in searches

## ğŸ‘¥ Contributors

- Claude Code

---

**Full Changelog:** v1.2.1...v1.3.0
