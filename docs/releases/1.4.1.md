# Release Notes: v1.4.1

**Release Date:** November 20, 2025

## üìö Documentation Improvements

This is a documentation-focused patch release that clarifies how database configurations work with the new `lshrc` system introduced in v1.4.0.

## What's New

### Enhanced Database Configuration Documentation

#### New Documentation
- **[DATABASE_CONFIG_GUIDE.md](../DATABASE_CONFIG_GUIDE.md)** - Comprehensive guide for configuring databases via `lshrc`
  - Practical examples for all three storage tiers
  - Team collaboration workflows
  - Environment switching patterns
  - Troubleshooting guide

#### Updated Documentation
- **[CONFIGURATION.md](../CONFIGURATION.md)** - Added database configuration examples
- **[.env.example](../../.env.example)** - Added deprecation notice directing users to `lshrc`

### Clarifications

#### Configuration Priority (Now Crystal Clear)
```
1. Built-in defaults (lowest priority)
2. ~/.config/lsh/lshrc  ‚Üê Recommended for database config
3. Environment variables ‚Üê Highest priority (for overrides)
```

**Key Point:** Database configurations (SUPABASE_URL, DATABASE_URL, etc.) should be set in `lshrc`, not `.env`

#### How It Works
```bash
# Recommended: Use lshrc for persistent config
lsh config set SUPABASE_URL https://your-project.supabase.co
lsh config set SUPABASE_ANON_KEY eyJhbGci...

# Now works everywhere automatically!
lsh daemon start
lsh push --env production
```

#### Override When Needed
```bash
# Use different database for one command
SUPABASE_URL=https://test.supabase.co lsh pull --env staging
```

## Bug Fixes

### Fixed Misleading Comment
**File:** `src/lib/config-manager.ts`

**Before:**
```typescript
// Config file values take precedence over environment variables
```

**After:**
```typescript
// Config file values are loaded into process.env, but existing environment
// variables take precedence (config provides defaults)
```

This accurately reflects how the system works.

## Examples

### Team Setup with Supabase
```bash
# Each team member sets in lshrc
lsh config set SUPABASE_URL https://team-project.supabase.co
lsh config set SUPABASE_ANON_KEY shared-key
lsh config set LSH_SECRETS_KEY shared-encryption-key

# Now everyone can sync
lsh pull --env production
```

### Multiple Environments
```bash
# Production config in lshrc
lsh config set SUPABASE_URL https://prod.supabase.co

# Override for staging
SUPABASE_URL=https://staging.supabase.co lsh pull --env staging
```

### Local PostgreSQL
```bash
docker-compose up -d
lsh config set DATABASE_URL postgresql://lsh_user:lsh_password@localhost:5432/lsh
lsh daemon start
```

## Migration from .env

If you've been setting database config in `.env`, migrate to `lshrc`:

```bash
# Initialize lshrc
lsh config init

# Migrate values
lsh config set SUPABASE_URL "$(grep SUPABASE_URL .env | cut -d= -f2)"
lsh config set SUPABASE_ANON_KEY "$(grep SUPABASE_ANON_KEY .env | cut -d= -f2)"

# Verify
lsh config list

# Remove from .env (keep only application secrets there)
```

## No Breaking Changes

- ‚úÖ Fully backward compatible with v1.4.0
- ‚úÖ Existing `.env` configurations continue to work
- ‚úÖ No code changes, only documentation improvements
- ‚úÖ All tests passing (451 tests)
- ‚úÖ CI passing

## Files Changed

- `src/lib/config-manager.ts` - Fixed comment about precedence
- `.env.example` - Added deprecation notice
- `docs/CONFIGURATION.md` - Enhanced with database examples
- `docs/DATABASE_CONFIG_GUIDE.md` - New comprehensive guide

## Upgrade

```bash
npm install -g lsh-framework@1.4.1
# or
npm update -g lsh-framework
```

## Related

- v1.4.0 - Initial release of config file system
- Issue #96 - Multi-tier onboarding

---

**Diff from v1.4.0:** https://github.com/gwicho38/lsh/compare/v1.4.0...v1.4.1
