# Release Notes - Version 0.5.8

**Release Date:** 2025-10-15
**Previous Version:** 0.5.7

## Summary

This release restructures the CLI command hierarchy to improve organization and discoverability. All service-related commands (`supabase`, `daemon`, `cron`, `secrets`) are now nested under the `lib` parent command, creating a cleaner and more intuitive command structure.

## Breaking Changes

### Command Structure Reorganization

**IMPORTANT:** Command paths have changed. Users and scripts will need to update their commands.

#### Before (v0.5.7 and earlier):
```bash
lsh supabase status
lsh daemon start
lsh daemon job list
lsh cron list
lsh secrets push
```

#### After (v0.5.8):
```bash
lsh lib supabase status
lsh lib daemon start
lsh lib daemon job list
lsh lib cron list
lsh lib secrets push
```

### Migration Guide

1. **Update scripts and aliases:**
   ```bash
   # Old
   alias lsh-start='lsh daemon start'

   # New
   alias lsh-start='lsh lib daemon start'
   ```

2. **Update CI/CD pipelines:**
   ```yaml
   # Old
   - run: lsh secrets pull

   # New
   - run: lsh lib secrets pull
   ```

3. **Update documentation:**
   - Search and replace command references
   - Update any integration guides or tutorials

## Features

### Improved Command Organization

**Benefits:**
- **Logical Grouping:** Service commands are now grouped under `lib`, making it clear these are library/service features
- **Cleaner Top-Level:** Main `lsh` command has fewer top-level subcommands, reducing visual clutter
- **Better Discovery:** `lsh lib --help` shows all service commands in one place
- **Future-Proof:** Easier to add new service commands without polluting the top-level namespace

**New Structure:**
```
lsh
├── -i (interactive shell)
├── -c (command execution)
├── config
├── self
├── api
├── zsh
├── theme
├── repl
└── lib
    ├── supabase
    ├── daemon
    │   ├── start/stop/status
    │   ├── job
    │   └── db
    ├── cron
    └── secrets
```

## Changes

### Modified Files

- `src/cli.ts`
  - Refactored command registration to nest service commands under `lib`
  - Updated help text and examples
  - Improved command descriptions

- `src/services/lib/lib.ts`
  - Enhanced to properly accept and register nested commands
  - Added description for lib command group

### Help Output

**Top-level help now shows:**
```bash
$ lsh --help

Commands:
  repl                    JavaScript REPL interactive shell
  script <file>           Execute shell script
  config                  Manage configuration
  zsh                     ZSH compatibility commands
  zsh-import              Import ZSH configs
  theme                   Manage themes
  self                    Self-management
  api                     API server management
  help                    Show detailed help

Library Commands (lsh lib <command>):
  lib supabase            Supabase database management
  lib daemon              Daemon management
  lib cron                Cron job management
  lib secrets             Secrets management
```

**Library commands:**
```bash
$ lsh lib --help

Commands:
  supabase        Supabase database management commands
  daemon          LSH daemon management commands
  cron            Cron job management with database integration
  secrets         Manage environment secrets across machines
```

## Examples

### Before and After Comparison

| Task | v0.5.7 | v0.5.8 |
|------|---------|---------|
| Start daemon | `lsh daemon start` | `lsh lib daemon start` |
| List jobs | `lsh daemon job list` | `lsh lib daemon job list` |
| Push secrets | `lsh secrets push` | `lsh lib secrets push` |
| List cron jobs | `lsh cron list` | `lsh lib cron list` |
| Check Supabase | `lsh supabase status` | `lsh lib supabase status` |

### Common Workflows

**Secrets Management:**
```bash
# Generate encryption key
lsh lib secrets key

# Push secrets to cloud
lsh lib secrets push -e prod

# Pull secrets on another machine
lsh lib secrets pull -e prod

# List all environments
lsh lib secrets list

# Show secrets for specific environment
lsh lib secrets list prod
```

**Daemon & Jobs:**
```bash
# Start daemon
lsh lib daemon start

# Check status
lsh lib daemon status

# List jobs
lsh lib daemon job list

# Create job
lsh lib daemon job create

# Trigger job
lsh lib daemon job trigger <id>
```

**Cron Management:**
```bash
# List cron jobs
lsh lib cron list

# Add cron job
lsh lib cron add

# Remove cron job
lsh lib cron remove
```

## Installation

```bash
npm install -g lsh-framework@latest
```

Or update existing installation:
```bash
lsh self update
```

## Updating

```bash
lsh self update
```

## Version Diff (0.5.7 → 0.5.8)

### Breaking Changes
- Command paths changed: service commands moved under `lib` parent command
- Scripts and automation using old paths need updates

### Improvements
- Better command organization and hierarchy
- Cleaner top-level command structure
- Improved discoverability of service commands
- More maintainable codebase for future additions

### Non-Breaking
- All command functionality remains the same
- Only the command paths have changed
- Help text updated throughout

## Support

If you encounter issues after updating:

1. **Check command paths:** Make sure you're using `lsh lib <command>` instead of `lsh <command>`
2. **Update aliases:** Review your shell aliases and update paths
3. **Test in isolation:** Try commands individually before updating scripts
4. **Rollback if needed:** `npm install -g lsh-framework@0.5.7`

## What's Next

This restructuring sets the foundation for:
- Additional library services
- Plugin system development
- Better namespace management
- More intuitive command discovery
