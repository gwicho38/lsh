# Release Notes: LSH v0.8.3

**Release Date:** October 30, 2025
**Previous Version:** v0.8.2
**Type:** Hotfix

## Overview

This hotfix release addresses a critical issue with the `--load` flag introduced in v0.8.2 where logger output was interfering with shell evaluation, causing zsh glob interpretation errors.

## 🐛 Bug Fix

### Logger Output Interference in Load Mode

**Problem:**
When using the `--load` flag for sync-and-load workflow:
```bash
eval "$(lsh lib secrets sync --load)"
```

Users encountered zsh glob interpretation errors:
```
zsh: no matches found: [SecretsManager]
```

**Root Cause:**
- Logger was outputting messages with `[SecretsManager]` context
- Zsh interpreted square brackets as glob pattern characters
- This corrupted the eval output and prevented secrets from loading

**Solution:**
- Suppress all logger output during `--load` mode execution
- Set logger level to `LogLevel.NONE` at start of load mode
- Restore original logger level after completion in finally block
- Only clean export commands now reach stdout

## 🔧 Technical Changes

### Modified Files

**`src/lib/secrets-manager.ts`**
- Import `LogLevel` from logger module
- Added logger suppression logic to `smartSync()` method
- Wrapped execution in try-finally block to ensure cleanup
- Saves and restores original logger level

```typescript
// In load mode, suppress all logger output
const originalLogLevel = loadMode ? logger['config'].level : undefined;
if (loadMode) {
  logger.setLevel(LogLevel.NONE);
}

try {
  // ... sync logic ...
} finally {
  // Restore original logger level
  if (loadMode && originalLogLevel !== undefined) {
    logger.setLevel(originalLogLevel);
  }
}
```

## ✅ Verification

After this fix, the load mode works correctly:

```bash
# No more errors!
eval "$(lsh lib secrets sync --load)"

# Secrets are loaded
echo $DATABASE_URL
# Output: postgresql://...
```

## 📊 Impact

- **Severity:** Critical - Feature was unusable
- **Scope:** Only affects `--load` flag usage
- **Users Affected:** Anyone attempting to use `eval "$(lsh lib secrets sync --load)"`
- **Backward Compatibility:** No breaking changes

## 🔄 Upgrade Instructions

### For Global Install
```bash
npm install -g lsh-framework@latest
```

### For Project Install
```bash
npm install lsh-framework@latest
```

### Verify Installation
```bash
lsh --version
# Should output: 0.8.3
```

## 🧪 Testing

Test the fix:
```bash
cd ~/repos/your-project

# This should now work without errors
eval "$(lsh lib secrets sync --load)"

# Verify secrets are loaded
env | grep DATABASE_URL
```

## 📝 Related Issues

- Fixes: zsh glob pattern interpretation in load mode
- Related: Smart Sync feature from v0.8.2

## 🔗 Links

- **NPM Package:** https://www.npmjs.com/package/lsh-framework/v/0.8.3
- **GitHub Release:** https://github.com/gwicho38/lsh/releases/tag/v0.8.3
- **Previous Release:** [v0.8.2](./0.8.2.md)

## 📅 Timeline

- **v0.8.2 Released:** October 30, 2025 (introduced Smart Sync with `--load` flag)
- **Issue Reported:** Same day as v0.8.2 release
- **v0.8.3 Released:** October 30, 2025 (hotfix)

## 🙏 Acknowledgments

Thank you to users who reported this issue immediately, allowing for a rapid hotfix release.

---

**Full Changelog:** https://github.com/gwicho38/lsh-framework/compare/v0.8.2...v0.8.3
