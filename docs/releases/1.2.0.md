# LSH v1.2.0 - Info Command

**Release Date:** 2025-11-06

## üéâ New Feature: `lsh info` Command

Show relevant context information for the current directory, including git repo details and tracked environment names.

## What's New

### `lsh info` Command

Get a comprehensive overview of your current directory's secrets configuration:

```bash
$ lsh info
```

**Output:**
```
üìç Current Directory Context

üìÅ Git Repository:
   Root: /Users/you/repos/myapp
   Name: myapp
   Branch: main
   Remote: git@github.com:you/myapp.git

üîê Environment Tracking:
   Base environment: dev
   Cloud storage name: myapp_dev
   Namespace: myapp
   ‚ÑπÔ∏è  Repo-based isolation enabled

üìÑ Local .env File:
   Path: /Users/you/repos/myapp/.env
   Keys: 12
   Size: 2.3 KB
   Has encryption key: ‚úÖ

‚òÅÔ∏è  Cloud Storage:
   Environment: myapp_dev
   Keys stored: 12
   Last updated: 11/6/2025, 10:15:23 PM
   Key matches: ‚úÖ

üí° Quick Actions:
   Push:  lsh push --env dev
   Pull:  lsh pull --env dev
   Sync:  lsh sync --env dev
```

## Why This Matters

### Understanding Environment Naming

**Key Insight:** LSH automatically namespaces environments based on your git repository name!

When you're in a git repository:
- **Base environment:** `dev` (what you type)
- **Cloud storage name:** `{repo}_dev` (what's actually stored)
- **Example:** If your repo is named `myapp`, secrets are stored as `myapp_dev`, `myapp_staging`, `myapp_prod`

This prevents conflicts when multiple projects use the same environment names.

### Use Cases

**1. Verify Environment Tracking**
```bash
cd ~/repos/app1
lsh info
# Shows: Cloud storage name: app1_dev

cd ~/repos/app2
lsh info
# Shows: Cloud storage name: app2_dev
```

**2. Check Sync Status**
```bash
lsh info
# See if local .env matches cloud
# Check encryption key status
# View last sync time
```

**3. Debug Mismatches**
```bash
lsh info
# Key matches: ‚ùå MISMATCH
# Now you know why pull/push isn't working!
```

**4. Team Onboarding**
```bash
# New team member clones repo
cd ~/repos/company-app
lsh info

# Shows exactly what environment is tracked
# Cloud storage name: company-app_dev
# Quick actions to get started
```

## Features

- ‚úÖ **Git Repository Detection** - Shows repo name, branch, remote
- ‚úÖ **Environment Namespace** - Displays actual cloud storage name
- ‚úÖ **Local File Status** - Keys count, size, encryption key check
- ‚úÖ **Cloud Sync Status** - Keys stored, last updated, key match status
- ‚úÖ **Quick Actions** - Copy-paste commands for common operations
- ‚úÖ **Non-Git Detection** - Warns when not in a git repo (no isolation)

## Command Options

```bash
lsh info                          # Default (.env, dev)
lsh info --env staging            # Check staging environment
lsh info --file .env.local        # Check custom file
```

## Environment Naming Explained

### In a Git Repository

When LSH detects you're in a git repository, it automatically namespaces your environments:

**Pattern:** `{repoName}_{environment}`

**Example:**
- Repo name: `myapp`
- Base environment: `dev`
- Cloud storage name: `myapp_dev`

**Benefits:**
- ‚úÖ Multiple projects can use `dev`, `staging`, `prod` without conflicts
- ‚úÖ Team members automatically sync the same environment
- ‚úÖ Clear separation between project secrets

### Outside a Git Repository

When not in a git repo, the base environment name is used directly:

**Pattern:** `{environment}`

**Example:**
- Base environment: `dev`
- Cloud storage name: `dev` (shared!)

**Warning:** All projects will share the same environment - use git repos for isolation!

## Example Workflows

### 1. Check Current Context
```bash
cd ~/repos/myapp
lsh info
# See repo: myapp
# See environment: myapp_dev
# Check sync status
```

### 2. Verify Before Push
```bash
lsh info
# Confirm environment name
# Check key count

lsh push
# Push with confidence
```

### 3. Debug Sync Issues
```bash
lsh pull
# Error: decryption failed

lsh info
# Key matches: ‚ùå MISMATCH
# Ah! Wrong encryption key!
```

### 4. Understand Multi-Project Setup
```bash
cd ~/repos/frontend
lsh info
# Cloud storage name: frontend_dev

cd ~/repos/backend
lsh info
# Cloud storage name: backend_dev

# Both use "dev" but are isolated!
```

## Implementation Details

### File Changes
- **`src/services/secrets/secrets.ts`** - Added `info` command
  - Git repository detection
  - Environment name calculation
  - Local file analysis
  - Cloud status check
  - Quick actions generation

### Data Displayed

**Git Repository:**
- Root path
- Repository name (extracted from remote URL or directory)
- Current branch
- Remote URL

**Environment Tracking:**
- Base environment (what you specify)
- Cloud storage name (actual namespaced name)
- Namespace (repo name or none)
- Isolation status

**Local .env File:**
- File path
- Number of keys
- File size
- Encryption key presence

**Cloud Storage:**
- Environment name (namespaced)
- Keys stored
- Last updated timestamp
- Key match status (encryption key validation)

## Documentation Updates

- ‚úÖ Added to Secrets Commands table in README
- ‚úÖ Added example output to README
- ‚úÖ Explained repo-based isolation
- ‚úÖ Updated Smart Sync section with `lsh info` reference

## Changelog

### Added
- `lsh info` command to show current directory context
- Git repository detection and display
- Environment namespace calculation
- Local file status (keys, size, encryption check)
- Cloud sync status (keys, last updated, key match)
- Quick action suggestions
- Warning for non-git directories (no isolation)

### Changed
- N/A

### Fixed
- N/A

## Upgrade Instructions

```bash
npm install -g lsh-framework@1.2.0
```

No migration needed - this is a pure addition!

## Related

- Environment naming uses `getRepoAwareEnvironment()` from `SecretsManager`
- Git utilities from `src/lib/git-utils.ts`
- Smart sync already used this naming scheme
- Status command provides similar data in JSON format

---

**Full Changelog**: https://github.com/gwicho38/lsh/compare/v1.1.0...v1.2.0
