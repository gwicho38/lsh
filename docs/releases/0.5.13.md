# Release Notes - Version 0.5.13

**Release Date:** 2025-10-15
**Previous Version:** 0.5.12

## Summary

This release adds a `--force` option to the `lsh lib secrets pull` command, allowing users to overwrite existing .env files without creating automatic backups.

## Features

### `--force` Option for Secrets Pull

The pull command now accepts a `--force` flag to skip automatic backup creation.

#### Before (v0.5.12):
```bash
$ lsh lib secrets pull

Pulling dev secrets from Supabase...
Backed up existing .env to .env.backup.1729012345678
✅ Pulled 15 secrets from Supabase
```

Every pull created a backup file automatically.

#### After (v0.5.13):
```bash
# Default behavior (creates backup)
$ lsh lib secrets pull
Pulling dev secrets from Supabase...
Backed up existing .env to .env.backup.1729012345678
✅ Pulled 15 secrets from Supabase

# With --force (no backup)
$ lsh lib secrets pull --force
Pulling dev secrets from Supabase...
✅ Pulled 15 secrets from Supabase
```

### Use Cases

**1. Development Workflow (Default - Safe)**
```bash
# Pull secrets with automatic backup
lsh lib secrets pull
# Safe: .env.backup.{timestamp} created
```

**2. CI/CD Pipelines (Force - Clean)**
```bash
# Pull secrets without backup in CI
lsh lib secrets pull --force
# Clean: No backup files created
```

**3. Docker Containers (Force - Clean)**
```bash
# Pull secrets in container startup
lsh lib secrets pull -e prod --force
# Clean: No backup clutter
```

**4. Frequent Updates (Force - No Clutter)**
```bash
# Update secrets multiple times during development
lsh lib secrets pull --force
lsh lib secrets pull --force
# Clean: No accumulation of backup files
```

## Command Reference

### Pull Command
```bash
lsh lib secrets pull [options]

Options:
  -f, --file <path>  Path to .env file (default: ".env")
  -e, --env <name>   Environment name (dev/staging/prod) (default: "dev")
  --force            Overwrite without creating backup
  -h, --help         display help for command
```

### Examples

**Pull with default backup:**
```bash
lsh lib secrets pull
lsh lib secrets pull -e staging
lsh lib secrets pull -f .env.production -e prod
```

**Pull without backup:**
```bash
lsh lib secrets pull --force
lsh lib secrets pull -e staging --force
lsh lib secrets pull -f .env.test -e test --force
```

**CI/CD Example:**
```yaml
# .github/workflows/deploy.yml
- name: Pull secrets
  run: lsh lib secrets pull -e production --force
```

**Docker Example:**
```dockerfile
# In entrypoint.sh
lsh lib secrets pull --force
npm start
```

## Changes

### Modified Files

- `src/lib/secrets-manager.ts`
  - Added `force` parameter to `pull()` method
  - Skips backup creation when `force` is true

- `src/services/secrets/secrets.ts`
  - Added `--force` option to pull command
  - Passes force flag to secrets manager

## Benefits

1. **CI/CD Friendly**: No backup file clutter in automated deployments
2. **Container Optimized**: Clean environment in Docker containers
3. **Flexible**: Choose safety (default) or speed (--force)
4. **Backwards Compatible**: Default behavior unchanged
5. **Clear Intent**: Explicit flag shows intentional behavior

## Safety Considerations

### When to Use Default (With Backup)
- ✅ Development machines
- ✅ Local testing
- ✅ Manual updates
- ✅ When you want to be safe

### When to Use --force (No Backup)
- ✅ CI/CD pipelines
- ✅ Docker containers
- ✅ Automated scripts
- ✅ Frequent updates
- ✅ When you're confident about the source

### Warning
⚠️ Using `--force` means you cannot easily revert to the previous .env content. Make sure you:
- Have secrets backed up in cloud (via `lsh lib secrets push`)
- Are confident about the pull source
- Don't need the old .env content

## Installation

```bash
npm install -g lsh-framework@latest
```

Or update existing installation:
```bash
lsh self update
```

## Version Diff (0.5.12 → 0.5.13)

### New Features
- `--force` option for `lsh lib secrets pull`

### Improvements
- Better control over backup behavior
- CI/CD friendly secrets management
- Reduced file clutter in automated environments

### Backwards Compatibility
- Default behavior unchanged (still creates backups)
- All existing workflows continue to work

## Breaking Changes

None - this release adds an optional feature without changing default behavior.

## What's Next

Future enhancements for secrets management:
- Backup management commands (list, restore, clean)
- Automatic backup rotation/cleanup
- Diff command to compare versions
- Merge command to combine env files
