apiVersion: v1
kind: Pod
metadata:
  name: "{{ .Release.Name }}-test"
  annotations:
    "helm.sh/hook": test
spec:
  restartPolicy: Never
  containers:
    - name: {{ .Release.Name }}-test
      image: '{{ .Values.c3Cluster.busybox.registry }}/{{ .Values.c3Cluster.busybox.repository }}:{{ .Values.c3Cluster.busybox.tag }}'
      imagePullPolicy: 'Always'
      # This is a dummy test to be expanded later which checks the health of the master node
      command:
        - /bin/bash
        - -ec
        - |
          [[ 1 == 1 ]] && exit 0 || exit 1
