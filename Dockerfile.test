# LSH Integration Test Dockerfile
FROM node:20.18.0-alpine

# Install dependencies
WORKDIR /app
COPY package*.json ./
RUN npm ci --only=production

# Copy source code
COPY . .
RUN npm run build

# Create directories for testing
RUN mkdir -p /app/test-data /app/logs /app/data /app/tests

# Set test environment
ENV NODE_ENV=test
ENV LSH_DEBUG=true

# Expose API port
EXPOSE 3030

# Default command for testing
CMD ["node", "dist/cli.js", "--version"]